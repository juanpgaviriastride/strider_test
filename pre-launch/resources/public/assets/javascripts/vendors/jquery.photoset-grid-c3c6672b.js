/**
 * photoset-grid - v1.0.1
 * 2014-04-08
 * jQuery plugin to arrange images into a flexible grid
 * http://stylehatch.github.com/photoset-grid/
 *
 * Copyright 2014 Jonathan Moore - Style Hatch
 */
!function(t,e,i,s){"use strict";function n(e,i){this.element=e,this.options=t.extend({},r,i),this._defaults=r,this._name=o,this.init()}var o="photosetGrid",r={width:"100%",gutter:"0px",highresLinks:!1,lowresWidth:500,rel:"",borderActive:!1,borderWidth:"5px",borderColor:"#000000",borderRadius:"0",borderRemoveDouble:!1,onInit:function(){},onComplete:function(){}};n.prototype={init:function(){this.options.onInit(),this._setupRows(this.element,this.options),this._setupColumns(this.element,this.options)},_callback:function(t){this.options.onComplete(t)},_setupRows:function(e,i){if(i.layout)this.layout=i.layout;else if(t(e).attr("data-layout"))this.layout=t(e).attr("data-layout");else{for(var s="",n=1,o=0;o<t(e).find("img").length;o++)s+=n.toString();this.layout=s}this.rows=this.layout.split("");for(var r in this.rows)this.rows[r]=parseInt(this.rows[r],10);var a=t(e).find("img"),l=0;t.each(this.rows,function(t,e){var i=l,s=l+e;a.slice(i,s).wrapAll('<div class="photoset-row cols-'+e+'"></div>'),l=s}),t(e).find(".photoset-row:not(:last-child)").css({"margin-bottom":i.gutter})},_setupColumns:function(i,s){var n=this,o=function(n){function o(){var e=t(i).width().toString();e!==t(i).attr("data-width")&&(r.each(function(){var e=t(this).find("img:eq(0)");t(this).find("img").each(function(){var i=t(this);i.attr("height")<e.attr("height")&&(e=t(this)),parseInt(i.css("width"),10)>s.lowresWidth&&i.attr("data-highres")&&i.attr("src",i.attr("data-highres"))});var i=e.attr("height")*parseInt(e.css("width"),10)/e.attr("width"),n=Math.floor(.025*i);t(this).height(i-n),s.borderActive&&t(this).find(".photoset-content-border").each(function(){t(this).css({height:i-n})}),t(this).find("img").each(function(){var e=t(this).attr("height")*parseInt(t(this).css("width"),10)/t(this).attr("width"),s=.5*(i-e)+"px";t(this).css({"margin-top":s})})}),t(i).attr("data-width",e))}var r=t(i).find(".photoset-row"),a=t(i).find("img");s.highresLinks?(a.each(function(){var e;e=t(this).attr("title")?' title="'+t(this).attr("title")+'"':"";var i;i=t(this).attr(t(this).attr("data-highres")?"data-highres":"src"),t(this).wrapAll('<a href="'+i+'"'+e+' class="photoset-cell highres-link" />'),s.borderActive&&t(this).wrapAll('<span class="photoset-content-border" />')}),s.rel&&a.parent().attr("rel",s.rel)):a.each(function(){s.borderActive?(t(this).wrapAll('<div class="photoset-cell photoset-cell--border" />'),t(this).wrapAll('<div class="photoset-content-border" />')):t(this).wrapAll('<div class="photoset-cell" />')});var l=t(i).find(".photoset-cell"),h=t(i).find(".cols-1 .photoset-cell"),c=t(i).find(".cols-2 .photoset-cell"),d=t(i).find(".cols-3 .photoset-cell"),u=t(i).find(".cols-4 .photoset-cell"),p=t(i).find(".cols-5 .photoset-cell"),f=t(i).find(".photoset-content-border");t(i).css({width:s.width}),r.css({clear:"left",display:"block",overflow:"hidden"}),l.css({"float":"left",display:"block","line-height":"0","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"}),a.css({width:"100%",height:"auto"}),s.borderActive&&f.css({display:"block",border:s.borderWidth+" solid "+s.borderColor,"border-radius":s.borderRadius,overflow:"hidden","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"}),n&&a.each(function(){t(this).attr("height",t(this).height()),t(this).attr("width",t(this).width())}),h.css({width:"100%"}),c.css({width:"50%"}),d.css({width:"33.3%"}),u.css({width:"25%"}),p.css({width:"20%"});var g=parseInt(s.gutter,10);t(i).find(".photoset-cell:not(:last-child)").css({"padding-right":g/2+"px"}),t(i).find(".photoset-cell:not(:first-child)").css({"padding-left":g/2+"px"}),s.borderRemoveDouble&&(t(i).find(".photoset-row").not(":eq(0)").find(".photoset-content-border").css({"border-top":"none"}),t(i).find(".photoset-row").not(".cols-1").find(".photoset-content-border").not(":eq(0)").css({"border-left":"none"})),o(),t(e).on("resize",function(){o()})},r=!0,a=!0;t(i).find("img").each(function(){a&=!!t(this).attr("height")&!!t(this).attr("width")}),r=!a,r?t(i).imagesLoaded(function(){o(r),n._callback(i)}):(o(r),n._callback(i))}},t.fn[o]=function(e){return this.each(function(){t.data(this,"plugin_"+o)||t.data(this,"plugin_"+o,new n(this,e))})};/*!
     * jQuery imagesLoaded plugin v2.1.1
     * http://github.com/desandro/imagesloaded
     *
     * MIT License. by Paul Irish et al.
     */
var a="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";t.fn.imagesLoaded=function(e){function i(){var i=t(u),s=t(p);l&&(p.length?l.reject(c,i,s):l.resolve(c)),t.isFunction(e)&&e.call(r,c,i,s)}function n(t){o(t.target,"error"===t.type)}function o(e,s){e.src!==a&&-1===t.inArray(e,d)&&(d.push(e),s?p.push(e):u.push(e),t.data(e,"imagesLoaded",{isBroken:s,src:e.src}),h&&l.notifyWith(t(e),[s,c,t(u),t(p)]),c.length===d.length&&(setTimeout(i),c.unbind(".imagesLoaded",n)))}var r=this,l=t.isFunction(t.Deferred)?t.Deferred():0,h=t.isFunction(l.notify),c=r.find("img").add(r.filter("img")),d=[],u=[],p=[];return t.isPlainObject(e)&&t.each(e,function(t,i){"callback"===t?e=i:l&&l[t](i)}),c.length?c.bind("load.imagesLoaded error.imagesLoaded",n).each(function(e,i){var n=i.src,r=t.data(i,"imagesLoaded");return r&&r.src===n?void o(i,r.isBroken):i.complete&&i.naturalWidth!==s?void o(i,0===i.naturalWidth||0===i.naturalHeight):void((i.readyState||i.complete)&&(i.src=a,i.src=n))}):i(),l?l.promise(r):r};/*
     * throttledresize: special jQuery event that happens at a reduced rate compared to "resize"
     *
     * latest version and complete README available on Github:
     * https://github.com/louisremi/jquery-smartresize
     *
     * Copyright 2012 @louis_remi
     * Licensed under the MIT license.
     *
     * This saved you an hour of work?
     * Send me music http://www.amazon.co.uk/wishlist/HNTU0468LQON
     */
var l,h,c,d=t.event,u={_:0},p=0;l=d.special.throttledresize={setup:function(){t(this).on("resize",l.handler)},teardown:function(){t(this).off("resize",l.handler)},handler:function(e,i){var s=this,n=arguments;h=!0,c||(setInterval(function(){p++,(p>l.threshold&&h||i)&&(e.type="throttledresize",d.dispatch.apply(s,n),h=!1,p=0),p>9&&(t(u).stop(),c=!1,p=0)},30),c=!0)},threshold:0}}(jQuery,window,document);